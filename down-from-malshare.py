import requests
import wget


def main():
    # Request API key from http://malshare.com/register.php
    api_key='ee1d6ad466bcd9064c5da9a89eebaa104e24a0591c924514f03a239f190d1d05'

    # List MD5 hashes from the past 24 hours

    listraw = requests.get(u'http://malshare.com/api.php?api_key=%s&action=getlistraw' % api_key).text

    list_MD5 = listraw.strip().split('\n')
    print ('Number of hash: %d' % (len(list_MD5)))
    del listraw

    for md5 in list_MD5:
        filename = wget.download(u'http://malshare.com/api.php?api_key=%s&action=getfile&hash=%s' % (api_key, md5))
        print ('Complete download file %s' % filename)


if __name__ == '__main__':
    main()