import scrapy

class DllfilesSpider(scrapy.Spider):
    name = "dll-files"

    def start_requests(self):
        import string
        yield self.make_requests_from_url("http://www.dll-files.com/dllindex/index-0-9.shtml")
        for c in string.lowercase:
            url = "http://www.dll-files.com/dllindex/index-%c.shtml"%c
            yield self.make_requests_from_url(url)


    def parse(self, response):
        # filename = response.url.split("/")[-2] + '.html'
        # with open(filename, 'wb') as f:
        #     f.write(response.body)
        outfile = '/home/dien/workspace/virus-detection/data/dll-link.txt'
        f = open(outfile, 'a')
        for sel in response.xpath('//ul/li'):
            link = sel.xpath('a/@href').extract()[0]
            f.write('%s\n'%link)
        f.close()